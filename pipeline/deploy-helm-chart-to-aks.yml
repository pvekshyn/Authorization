parameters:
  - name: serviceName
    type: string

steps:
  - task: HelmDeploy@0
    displayName: Helm deploy
    inputs:
      connectionType: Kubernetes Service Connection
      kubernetesServiceConnection: pvauthorizationaks-sc
      command: upgrade
      chartType: 'Name'
      chartName: 'pvauthorizationcr.azurecr.io/api-service:1.0.0'
      releaseName: ${{ parameters.serviceName }}-helm
      valueFile: pipeline/helm/api-service/${{ parameters.serviceName }}-values.yaml
      recreate: true
      install: true
      waitForExecution: true

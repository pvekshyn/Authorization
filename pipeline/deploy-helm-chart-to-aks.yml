parameters:
  - name: serviceName
    type: string

steps:
  - task: HelmDeploy@0
    displayName: Helm deploy
    inputs:
      connectionType: Kubernetes Service Connection
      kubernetesServiceConnection: pvauthorizationaks-sc
      command: upgrade
      chartType: filepath
      chartPath: pipeline/helm/api-service
      releaseName: ${{ parameters.serviceName }}-helm
      valueFile: pipeline/helm/api-service/${{ parameters.serviceName }}-values.yaml
      recreate: true
      install: true
      waitForExecution: true
